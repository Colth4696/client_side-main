{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Users/colthafer/client_side-main/src/MyMarker.js\",\n    _s = $RefreshSig$();\n\nimport React from \"react\";\nimport { Marker, InfoWindow } from \"react-google-maps\";\nimport RedIcon from \"./red-user-icon.png\";\nimport GreenIcon from \"./green-home-icon.png\";\nimport axios from \"axios\";\nimport ModalChat from \"./ChatModal\";\nimport FulfilledButton from \"./Fulfilled\";\n\nconst MyMarker = props => {\n  _s();\n\n  const [hideMarker, setHideMarker] = React.useState(false);\n  const [flag, setFlag] = React.useState(false);\n  const [chat, setChat] = React.useState(false);\n  const [volunteer, setVolunteer] = React.useState();\n  const [hasMaxVolunteers, setHasMaxVolunteers] = React.useState();\n  const [loadingState, setLoadingState] = React.useState('loading');\n  React.useEffect(() => {\n    axios.get(`http://localhost:3003/volunteers`, {\n      request_id: props.request.id\n    }).then(response => {\n      const volunterList = response.data.volunteers;\n      let hasVolunteered = false;\n      const requestVolunteers = [];\n      volunterList.forEach(rv => {\n        if (rv.request_id === props.request.id) {\n          if (rv.user_id === props.user.id) {\n            hasVolunteered = true;\n            setVolunteer(rv);\n          } else {\n            requestVolunteers.push(rv);\n          }\n        }\n      });\n      const hasMax = requestVolunteers.length >= 5 || hasVolunteered;\n      setHasMaxVolunteers(hasMax);\n      setLoadingState('loaded');\n    });\n  }, [props.request.id, props.user.id]);\n\n  const go_away = () => {\n    if (props.request.fulfilled === true) {\n      return setHideMarker(!hideMarker);\n    } else {\n      return /*#__PURE__*/_jsxDEV(Marker, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 43,\n        columnNumber: 19\n      }, this);\n    }\n  };\n\n  const toggle_open = () => {\n    setFlag(!flag);\n  };\n\n  const getIcon = () => {\n    if (props.request.category === \"Material\") {\n      return RedIcon;\n    } else {\n      return GreenIcon;\n    }\n  };\n\n  const makeVolunteer = () => {\n    const volunteer = {\n      request_id: props.request.id,\n      user_id: props.user.id\n    };\n    console.log(props.user);\n    console.log(volunteer);\n    axios.post(\"http://localhost:3003/volunteers\", {\n      volunteer\n    }, {\n      params: {\n        _limit: 5\n      }\n    }).then(response => {\n      console.log(response.data);\n\n      if (response.data.status === \"created\") {\n        setChat(true);\n        setVolunteer(response.data.volunteer);\n      }\n    }).catch(error => {\n      console.error(`error:${error}`);\n    });\n  };\n\n  const MarkStyle = {\n    height: \"30px\",\n    width: \"30px\"\n  };\n  return loadingState === 'loading' ? loadingState : /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"marker\",\n    children: [/*#__PURE__*/_jsxDEV(Marker, {\n      useState: go_away,\n      style: MarkStyle,\n      position: props.position,\n      onClick: toggle_open,\n      icon: getIcon(),\n      children: flag && /*#__PURE__*/_jsxDEV(InfoWindow, {\n        onCloseClick: toggle_open,\n        user: props.user,\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"requestInfo\",\n          children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n            children: [\"Task ID:\", props.request.id]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 93,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n            children: [\"Requester ID:\", props.request.user_id]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 94,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n            children: props.request.title\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 95,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n            children: props.request.description\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 96,\n            columnNumber: 15\n          }, this), !chat && !hasMaxVolunteers ? /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: makeVolunteer,\n            children: \"Volunteer\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 97,\n            columnNumber: 45\n          }, this) : '', /*#__PURE__*/_jsxDEV(\"div\", {\n            children: volunteer && /*#__PURE__*/_jsxDEV(FulfilledButton, {\n              fulfillRequest: props.fulfillRequest,\n              request: props.request\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 99,\n              columnNumber: 31\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 98,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 20\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chatBox\",\n      children: chat && /*#__PURE__*/_jsxDEV(ModalChat, {\n        request: props.request,\n        volunteer: volunteer\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 20\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 82,\n    columnNumber: 7\n  }, this);\n};\n\n_s(MyMarker, \"huQIJ53XgE3uUoQkOVePb27moKo=\");\n\n_c = MyMarker;\nexport default MyMarker;\n\nvar _c;\n\n$RefreshReg$(_c, \"MyMarker\");","map":{"version":3,"sources":["/Users/colthafer/client_side-main/src/MyMarker.js"],"names":["React","Marker","InfoWindow","RedIcon","GreenIcon","axios","ModalChat","FulfilledButton","MyMarker","props","hideMarker","setHideMarker","useState","flag","setFlag","chat","setChat","volunteer","setVolunteer","hasMaxVolunteers","setHasMaxVolunteers","loadingState","setLoadingState","useEffect","get","request_id","request","id","then","response","volunterList","data","volunteers","hasVolunteered","requestVolunteers","forEach","rv","user_id","user","push","hasMax","length","go_away","fulfilled","toggle_open","getIcon","category","makeVolunteer","console","log","post","params","_limit","status","catch","error","MarkStyle","height","width","position","title","description","fulfillRequest"],"mappings":"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","sourcesContent":["import React from \"react\"\r\nimport { Marker, InfoWindow } from \"react-google-maps\"\r\nimport RedIcon from \"./red-user-icon.png\"\r\nimport GreenIcon from \"./green-home-icon.png\"\r\nimport axios from \"axios\"\r\nimport ModalChat from \"./ChatModal\"\r\nimport FulfilledButton from \"./Fulfilled\"\r\n\r\n\r\nconst MyMarker = (props) => {\r\n  const [hideMarker, setHideMarker] = React.useState(false);\r\n  const [flag, setFlag] = React.useState(false);\r\n  const [chat, setChat] = React.useState(false);\r\n  const [volunteer, setVolunteer] = React.useState();\r\n  const [hasMaxVolunteers, setHasMaxVolunteers] = React.useState();\r\n  const [loadingState, setLoadingState] = React.useState('loading');\r\n\r\n  React.useEffect(() => {\r\n    axios.get(`http://localhost:3003/volunteers`, { request_id: props.request.id })\r\n      .then(response => {\r\n        const volunterList = response.data.volunteers;\r\n        let hasVolunteered = false;\r\n        const requestVolunteers = [];\r\n        volunterList.forEach(rv => {\r\n          if (rv.request_id === props.request.id) {\r\n            if (rv.user_id === props.user.id) {\r\n              hasVolunteered = true;\r\n              setVolunteer(rv);\r\n            } else {\r\n              requestVolunteers.push(rv);\r\n            }\r\n          }\r\n        });\r\n        const hasMax = requestVolunteers.length >= 5 || hasVolunteered;\r\n        setHasMaxVolunteers(hasMax);\r\n        setLoadingState('loaded');\r\n      })\r\n  }, [props.request.id, props.user.id])\r\n\r\n  const go_away = () => {\r\n    if (props.request.fulfilled === true) { return setHideMarker(!hideMarker) }\r\n\r\n    else { return <Marker /> }\r\n  }\r\n\r\n  const toggle_open = () => {\r\n    setFlag(!flag)\r\n  }\r\n\r\n  const getIcon = () => {\r\n    if (props.request.category === \"Material\") { return RedIcon }\r\n    else { return GreenIcon }\r\n  }\r\n\r\n  const makeVolunteer = () => {\r\n    const volunteer = {\r\n      request_id: props.request.id,\r\n      user_id: props.user.id\r\n    }\r\n    console.log(props.user)\r\n    console.log(volunteer)\r\n    axios.post(\"http://localhost:3003/volunteers\", { volunteer }, { params: { _limit: 5 } })\r\n      .then(response => {\r\n        console.log(response.data)\r\n        if (response.data.status === \"created\") {\r\n          setChat(true)\r\n          setVolunteer(response.data.volunteer)\r\n        }\r\n      })\r\n      .catch(error => {\r\n        console.error(`error:${error}`)\r\n      })\r\n  }\r\n\r\n  const MarkStyle = {\r\n    height: \"30px\",\r\n    width: \"30px\"\r\n  }\r\n\r\n  return (\r\n    loadingState === 'loading' ? loadingState :\r\n      <div className=\"marker\">\r\n        <Marker\r\n          useState={go_away}\r\n          style={MarkStyle}\r\n          position={props.position}\r\n          onClick={toggle_open}\r\n          icon={getIcon()}>\r\n\r\n          {flag && <InfoWindow onCloseClick={toggle_open} user={props.user}>\r\n\r\n            <div className=\"requestInfo\">\r\n              <h4>Task ID:{props.request.id}</h4>\r\n              <h4>Requester ID:{props.request.user_id}</h4>\r\n              <h1>{props.request.title}</h1>\r\n              <h3>{props.request.description}</h3>\r\n              {!chat && !hasMaxVolunteers ? <button onClick={makeVolunteer}>Volunteer</button> : ''}\r\n              <div>\r\n                {volunteer && <FulfilledButton fulfillRequest={props.fulfillRequest} request={props.request} />}\r\n              </div>\r\n            </div>\r\n          </InfoWindow>}\r\n        </Marker>\r\n        <div className=\"chatBox\">\r\n          {chat && <ModalChat request={props.request} volunteer={volunteer} />}\r\n        </div>\r\n      </div>\r\n  )\r\n}\r\n\r\n\r\nexport default MyMarker"]},"metadata":{},"sourceType":"module"}